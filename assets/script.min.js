let c=document.querySelector("#canvas"),bannerMulai=document.querySelector(".bannerMulai"),bannerUlangi=document.querySelector(".bannerUlangi"),livesshow=document.querySelector("#livesshow"),scoreshow=document.querySelector("#scoreshow"),desc=document.querySelector(".desc"),title=document.querySelector("#title"),ctx=c.getContext("2d"),bAtas=0,bBawah=c.height-3,bKiri=0,bKanan=c.width,brick=[[]],papan={},panjangPapan=40,speedPapan=10,ball={},score=0,gamePoint=20,level1=!1,level2=!1,level3=!1,levelUp=!1,gravity=5,bolaJatuh=!0,kemiringan=0,lives=0;function $(a){let e={};switch(typeof a){case"object":e={on:(e,n)=>{a.addEventListener(e,n,!1)}};break;case"string":e={on:(e,n)=>{document.querySelector(a).addEventListener(e,n,!1)}}}return e}function drawRect(a){ctx.fillStyle=a.color,ctx.fillRect(a.x,a.y,a.width,a.height)}function drawCircle(a){ctx.beginPath(),ctx.fillStyle=a.color,ctx.arc(a.x,a.y,a.width,0,2*Math.PI),ctx.fill()}function is_collision(a,e,n,l=null){a.x-a.width/8<e.x+e.width/2&&a.x+(a.width+a.width/4)>e.x+e.width/2&&a.y-2*a.height<e.y+e.width/2&&a.y+2*a.height>e.y+e.width/2&&n(),null!=l&&l()}function genColor(){let a=["red","yellow","green"],e=Math.floor(1e6*Math.random()),n=0,l="";for(let i=0;i<e;i++)l=a[n],++n>a.length-1&&(n=0);return l}function initComp(){level1=!1,level2=!1,level3=!1,levelUp=!1,ball={x:bKanan/2,y:bBawah/2,width:5,color:"green"},papan={x:bKanan/2-panjangPapan/2,y:bBawah,width:panjangPapan,height:2,color:"yellow"};for(let a=0;a<3;a++){let e=[];for(let n=0;n<7;n++){let l=genColor();"red"==l?e[n]={x:43*n+1,y:10*a,width:40,height:9,color:l,brickDestroyHit:1,brickScore:1,crash:!1}:"yellow"==l?e[n]={x:43*n+1,y:10*a,width:40,height:9,color:l,brickDestroyHit:2,brickScore:2,crash:!1}:"green"==l&&(e[n]={x:43*n+1,y:10*a,width:40,height:9,color:l,brickDestroyHit:3,brickScore:3,crash:!1})}brick[a]=e}score=0,lives=3}function crashed(){for(let a=0;a<brick.length;a++)for(let e=0;e<brick[a].length;e++)brick[a][e].crash||is_collision(brick[a][e],ball,()=>{brick[a][e].brickDestroyHit-=1,bolaJatuh=!0,0==brick[a][e].brickDestroyHit&&(score+=brick[a][e].brickScore,brick[a][e].crash=!0)})}function drawBrick(){for(let a=0;a<brick.length;a++)for(let e=0;e<brick[a].length;e++)brick[a][e].crash||drawRect(brick[a][e])}function drawPapan(){is_collision(papan,ball,function(){papan.x+papan.width/2+panjangPapan/2-ball.x<panjangPapan/2?kemiringan=.2*(panjangPapan/2-(papan.x+papan.width/2+panjangPapan/2-ball.x)):papan.x+papan.width/2+panjangPapan/2-ball.x>panjangPapan/2?kemiringan=.2*(panjangPapan/2-(papan.x+papan.width/2+panjangPapan/2-ball.x)):papan.x+papan.width/2+panjangPapan/2-ball.x==panjangPapan/2&&(kemiringan=.2*(papan.x+papan.width/2+panjangPapan/2-ball.x-panjangPapan/2)),bolaJatuh=!1}),drawRect(papan)}function drawBall(){bolaJatuh?(ball.y+=gravity,ball.x+=kemiringan):bolaJatuh||(ball.y-=gravity-.5,ball.x+=kemiringan),ball.y<bAtas+ball.width/2+gravity&&(bolaJatuh=!0),ball.y>bBawah+20&&(lives-=1,ball.y=bBawah/2,kemiringan=0),ball.x<bKiri+ball.width&&(kemiringan=-kemiringan),ball.x>bKanan-ball.width&&(kemiringan=-kemiringan),drawCircle(ball)}function board(){livesshow.innerHTML=lives,scoreshow.innerHTML=score,lives<1?(title.innerHTML="You Lose",bannerUlangi.style.display="block",clearInterval(app)):score>gamePoint&&(title.innerHTML="You Win",bannerUlangi.style.display="block",clearInterval(app))}function levelUP(){levelUp&&(gravity+=.5,levelUp=!1)}function leveling(){score>=5&&!level1&&(level1=!0,levelUp=!0),score>=10&&!level2&&(level2=!0,levelUp=!0),score>=15&&!level3&&(level3=!0,levelUp=!0),levelUP()}function draw(){ctx.clearRect(0,0,c.width,c.height),drawBall(),drawPapan(),drawBrick(),crashed(),board(),leveling()}function init(){app=setInterval(()=>{draw()},50)}$(document).on("keydown",a=>{switch(a.code){case"ArrowLeft":papan.x>bKiri&&(papan.x-=speedPapan);break;case"ArrowRight":papan.x<bKanan-papan.width&&(papan.x+=speedPapan)}}),desc.innerHTML=desc.innerHTML.replace("pointInView",gamePoint),$("#btnMulai").on("click",()=>{bannerMulai.style.display="none",initComp(),init()}),$("#btnUlangi").on("click",()=>{bannerUlangi.style.display="none",initComp(),init()});